<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="A a method to align diffusion planners with model‐based optimization via importance‐sampled joint sampling, yielding safer, high‐fidelity robot motion plans without extra training.">
  <meta name="keywords" content="Diffusion Model, IL, Constrained Generation, SafetyFilter">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>JM2D: Joint Model-based Model-free Diffusion</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/jm2d.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://wonsuhkjung.wordpress.com/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://saferoboticslab.me.gatech.edu/research/parc/">
            PARC
          </a>
          <a class="navbar-item" href="https://safe-robotics-lab-gt.github.io/rail/">
            RAIL
          </a>
          <!-- Add other research here -->
        </div>
      </div>
    </div>

  </div>
</nav>

<!-- 
      Author blocks
-->

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Joint Model-based Model-free Diffusion for Planning with Constraints</h1>
          <!-- Authors -->
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://wonsuhkjung.wordpress.com/">Wonsuhk Jung*</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://umishra.me/">Utkarsh Mishra*</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/nadun-ranawaka-arachchige-87701b137/">Nadun Ranawaka</a><sup>1</sup>,
            </span>
          </div>
          <!-- Professors -->
          <div class="is-size-5 publication-authors"> 
            <span class="author-block">
              <a href="https://yongxin.ae.gatech.edu/">Yongxin Chen<span>&#8224;</span></a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://faculty.cc.gatech.edu/~danfei/">Danfei Xu<span>&#8224;</span></a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.shreyaskousik.com/">Shreyas Kousik<span>&#8224;</span></a><sup>1</sup>,
          </div>

          <div class="is-size-6 publication-authors">
            <span class="author-block"><sup>1</sup>Georgia Institute of Technology</span>
          </div>

          <div class="is-size-8 publication-authors">
            <span class="author-block"><sup></sup>* Equal authorship, <span>&#8224;</span> Equal advising,</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <div id="preparation-box" class="preparation-box">The link is in preparation</div>
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2509.08775"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2509.08775"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              
              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=NnsgGu1TmrA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>

              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/goldenhazard/JM2D_release"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- teaser -->
<!-- TODO: make teaser video for the RAIL-->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" class="is-centered" autoplay muted loop playsinline width="65%" height="65%" style="display: block; margin: auto; ; margin-bottom: 20px;">
        <source src="./static/videos/rail_teaser_speed.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle">
        <p>
        <b>How do we bridge the gap between what robots can achieve and what they can safely execute?</b>
        We propose <b>Joint Model-based Model-free Diffusion (JM2D)</b>: a unified diffusion framework that combines the expressiveness of model-free planning with the safety guarantees of model-based optimization, enabling robots to achieve both <b>performance</b> and <b>safety</b>.
      </p>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Model-free diffusion planners have shown great promise for robot motion planning, 
            but practical robotic systems often require combining them with model-based 
            optimization modules to enforce constraints, such as safety.  Naively integrating 
            these modules presents compatibility challenges when diffusion's multi-modal outputs 
            behave adversarially to optimization-based modules. To address this, we introduce 
            Joint Model-based Model-free Diffusion (JM2D), a novel generative modeling framework.  
            JM2D formulates module integration as a joint sampling problem to maximize compatibility 
            via an interaction potential, without additional training. Using importance sampling, 
            JM2D guides modules outputs based only on evaluations of the interaction potential, 
            thus handling non-differentiable objectives commonly arising from non-convex optimization 
            modules. We evaluate JM2D via application to aligning diffusion planners with safety 
            modules on offline RL and robot manipulation. JM2D significantly improves task performance 
            compared to conventional safety filters without sacrificing safety. Further, we show that 
            conditional generation is a special case of JM2D and elucidate key design choices by 
            comparing with SOTA gradient-based and projection-based diffusion planners.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <!-- <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
          <video id="teaser" controls playsinline height="100%">
                <source src="./static/videos/JM2D_1min.mp4"
                        type="video/mp4">
          </video>
        </div>
      </div>
    </div>
    <!--/ Paper video. -->
  </div>
</section>

<section class="section is-light is-small">
  <div class="container is-max-desktop">
    <h3 class="title is-3 has-text-centered"> Method </h3>
    <h3 class="title is-3 has-text-centered"> How can we generate diffusion-based
      plans with feasible safety correction? </h3>
    <div class="content mb-5">
      <p>
        Model-based diffusion planners can guarantee constraint satisfaction, but they often produce overly conservative plans
        failing to satisfy goal-completion objectives.
      </p>
      <p>
        On the other hand, model-free diffusion planners can generate high-quality plans to achieve goal-completion objectives,
        but they often violate constraints, leading to unsafe behaviors.
      </p>
      <p>
        How can we mutually align <b>model-free diffusion planner</b> and <b>model-based optimization module?</b>
      </p>
    </div>

    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <img src="./static/videos/method.mp4"
             alt="Motivation figure showing the gap between model-free diffusion planner and model-based optimization module."/>
      </div>
    </div>
  </div>



  <div class="container is-max-desktop">
    <h2 class="title is-5 has-text-centered"> Joint Model-based Model-free Diffusion (JM2D)</h2>
    <h4 class="subtitle is-5 has-text-centered"> A unified diffusion framework for planning and optimization </h4>
    <div class="content mb-5">
      <p>
        <b>Key Idea:</b> Recast planning-and-optimization as sampling from a joint distribution defined by 
        an interaction potential. In robotics, this interaction potential is often <i>non-differentiable</i>!
      </p>
      <p>
        <b>Key Idea:</b> Use Monte-Carlo approximation of the joint score, requiring only 
        zero-th order information. This enables diffusion to reason jointly about goals and safety.
      </p>
    </div>
  </div>
</section>

<!-- Maze Example -->
<!-- Placeholder for maze video carousel -->
<!-- Fun Idea: can user select initial position, goal? -->
<section class="section is-light is-small">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered"> What can JM2D do?</h2>
    <div class="content mb-5">
      <h2 class="title is-4"> (1) JM2D increases system performance under strict safety guarantee</h2>
      <p style="margin-bottom: 20px;">          
        JM2D aligns goal achievement with real-time safety constraints. 
        In the 2D maze environment, naive diffusion quickly fails when unseen obstacles are introduced.
      </p>
      <p style="margin-bottom: 20px;">
        By sampling plans and backup safety corrections together, JM2D achieves higher safe success rates, 
        fewer interventions, and faster completion times compared to sequential or Gibbs sampling baselines.
      </p>

      <div class="columns is-centered">
        <div class="column">
          <div class="content">
            <h2 class="title is-5"> Safer Navigation in Complex Mazes</h2>
            <p>
              A robot must reach the goal without colliding with walls, even when wall boundaries are 
              padded at inference time. JM2D adapts gracefully, maintaining both safety and efficiency.
            </p>
            <video id="maze-demo" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/video1.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-4">(2) JM2D generalizes Conditional Generation and Model-based Diffusion</h2>
    <p style="margin-bottom: 20px;">          
      Conditional diffusion methods impose external constraints after sampling. 
      Model-based diffusion ensures constraints but struggles with task completion. 
    </p>
    
    <p style="margin-bottom: 20px;">
      JM2D unifies both approaches by directly sampling from their joint distribution, 
      maintaining compatibility between task objectives and safety constraints throughout the generation process.
    </p>

    <div class="columns is-centered">
      <div class="column">
        <div class="content">
          <h2 class="title is-5"> Unified Diffusion Framework</h2>
          <p>
            JM2D reduces intervention rates and improves plan quality, 
            showing how joint sampling can outperform both conditional and model-based diffusion individually.
          </p>
          <video id="conditional-demo" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/video2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-4">(3) JM2D generalizes to Joint Model-based Model-free Generation (JM2G)</h2>
    <p> 
      Beyond motion planning, JM2D extends naturally to broader generative modeling tasks. 
      This perspective—Joint Model-based Model-free Generation (JM2G)—opens possibilities in 
      areas like safe trajectory design, interactive decision making, and constrained 
      generative AI where feasibility and creativity must coexist. 
    </p>
  </div>
</section>

<!-- Placeholder for bibliography -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{
    jung2025joint,
    title={Joint Model-based Model-free Diffusion for Planning with Constraints},
    author={Wonsuhk Jung and Utkarsh Aashu Mishra and Nadun Ranawaka Arachchige and Yongxin Chen and Danfei Xu and Shreyas Kousik},
    booktitle={9th Annual Conference on Robot Learning},
    year={2025},
    url={https://openreview.net/forum?id=E9t1ekt6W9}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is based on the <a href = "https://nerfies.github.io/"> Nerfies </a> website template, which is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
