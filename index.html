<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="A a method to align diffusion planners with model‐based optimization via importance‐sampled joint sampling, yielding safer, high‐fidelity robot motion plans without extra training.">
  <meta name="keywords" content="Diffusion Model, IL, Constrained Generation, SafetyFilter">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>JM2D: Joint Model-based Model-free Diffusion</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <script>
    function handleVideoEnd(video) {
      // Pause at the last frame
      video.pause();
      // Wait for 2 seconds before starting next loop
      setTimeout(() => {
        video.currentTime = 0;
        video.play();
      }, 3000); // 2000ms = 2 seconds pause
    }
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css?v=2025-09-22-1">
  <link rel="icon" href="./static/images/jm2d.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<style>
  /* Only show the active video panel */
  .video-content { display: none; }
  .video-content.is-active { display: block; }
</style>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://wonsuhkjung.wordpress.com/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://saferoboticslab.me.gatech.edu/research/parc/">
            PARC
          </a>
          <a class="navbar-item" href="https://safe-robotics-lab-gt.github.io/rail/">
            RAIL
          </a>
          <!-- Add other research here -->
        </div>
      </div>
    </div>

  </div>
</nav>

<!-- 
      Author blocks
-->

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Joint Model-based Model-free Diffusion for Planning with Constraints</h1>
          <!-- Authors -->
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://wonsuhkjung.wordpress.com/">Wonsuhk Jung*</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://umishra.me/">Utkarsh Mishra*</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/nadun-ranawaka-arachchige-87701b137/">Nadun Ranawaka</a><sup>1</sup>,
            </span>
          </div>
          <!-- Professors -->
          <div class="is-size-5 publication-authors"> 
            <span class="author-block">
              <a href="https://yongxin.ae.gatech.edu/">Yongxin Chen<span>&#8224;</span></a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://faculty.cc.gatech.edu/~danfei/">Danfei Xu<span>&#8224;</span></a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.shreyaskousik.com/">Shreyas Kousik<span>&#8224;</span></a><sup>1</sup>,
          </div>

          <div class="is-size-6 publication-authors">
            <span class="author-block"><sup>1</sup>Georgia Institute of Technology</span>
          </div>

          <div class="is-size-8 publication-authors">
            <span class="author-block"><sup></sup>* Equal authorship, <span>&#8224;</span> Equal advising,</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <div id="preparation-box" class="preparation-box">The link is in preparation</div>
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2509.08775"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2509.08775"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              
              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=NnsgGu1TmrA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>

              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/goldenhazard/JM2D_release"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Coming Soon)</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- teaser -->
<!-- TODO: make teaser video for the RAIL-->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" class="is-centered" autoplay muted loop playsinline width="80%" height="80%" style="display: block; margin: auto; ; margin-bottom: 20px;">
        <source src="./static/videos/JM2D_teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle">
        <p>
        How do we bridge the gap between what robots can achieve and what they can safely execute?
        </p>
        <p>
        We propose <b class="viridis-text">Joint Model-based Model-free Diffusion (JM2D)</b>: a unified diffusion framework that combines the expressiveness of model-free planning with the safety guarantees of model-based optimization, enabling robots to achieve both <b>performance</b> and <b>safety</b>.
      </p>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Model-free diffusion planners have shown great promise for robot motion planning, 
            but practical robotic systems often require combining them with model-based 
            optimization modules to enforce constraints, such as safety.  Naively integrating 
            these modules presents compatibility challenges when diffusion's multi-modal outputs 
            behave adversarially to optimization-based modules. To address this, we introduce 
            Joint Model-based Model-free Diffusion (JM2D), a novel generative modeling framework.  
            JM2D formulates module integration as a joint sampling problem to maximize compatibility 
            via an interaction potential, without additional training. Using importance sampling, 
            JM2D guides modules outputs based only on evaluations of the interaction potential, 
            thus handling non-differentiable objectives commonly arising from non-convex optimization 
            modules. We evaluate JM2D via application to aligning diffusion planners with safety 
            modules on offline RL and robot manipulation. JM2D significantly improves task performance 
            compared to conventional safety filters without sacrificing safety. Further, we show that 
            conditional generation is a special case of JM2D and elucidate key design choices by 
            comparing with SOTA gradient-based and projection-based diffusion planners.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <!-- <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
          <video id="teaser" controls playsinline height="100%">
                <source src="./static/videos/JM2D_1min.mp4"
                        type="video/mp4">
          </video>
        </div>
      </div>
    </div>
    <!--/ Paper video. -->
  </div>
</section>

<section class="section is-light is-small">
  <div class="container is-max-desktop">
    <h3 class="title is-3 has-text-centered">Method: How does <b class="viridis-text">JM2D</b> work?</h3>
    <h4 class="subtitle is-5 has-text-centered">A unified diffusion framework for planning and optimization</h4>
  
    <div class="content mb-5">
      <p>
        <b>Problem.</b> Model-based planners are safe but less capable; model-free diffusion planners are capable but unsafe.
        How can we mutually align <b>model-free diffusion planner</b> and <b>model-based optimization module?</b>
      </p>
    </div>

    <div class="container is-max-desktop">
      <div class="content mb-5">
        <p>
          <b>Key idea.</b> Treat planning (<i>x</i>) and optimization variables (<i>k</i>) as a <b class="viridis-text">joint distribution</b> with an
          interaction potential that scores their compatibility. Then sample <i>(x, k)</i> jointly with diffusion—no extra training.
          We estimate the <b class="viridis-text"> joint denoising score</b> via Monte Carlo using only zeroth-order evaluations, enabling
          performance–safety reasoning that is <b>gradient-free</b> and <b>training-free</b>.
        </p>
      </div>
    </div>
  
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <video controls playsinline height="100%">
          <source src="./static/videos/method.mp4" type="video/mp4">
        </video>
      </div>
    </div>
  </div>
  

</section>

<!-- ------------------------------------------------ -->
<!-- Donut Videos Section with Tabs -->
 <!-- ------------------------------------------------ -->


<section class="section has-background-info-light">
  <div class="container is-max-desktop">
    <!-- Text -->
    <h2 class="title is-3 has-text-centered"> 🍩 Toy Example: Donut <span class="has-text-weight-normal is-size-6" style="margin-left: 1em;"></span></h2>

    <p class="is-4" style="max-width: 800px; margin: 0 auto 1.5rem auto;">
      <b> Overview.</b> We provide the following toy problem as an illustrative example.
    </p>

    <!-- Video Tabs -->
    <div class="tabset">
      <div class="tabs is-centered is-medium mb-3 real-world-tabs">
        <ul>
          <li data-target="donut-video1" class="tab-item is-active">
            <a class="has-text-weight-bold">
              <span class="icon-text">
                <span class="icon">
                  <i class="fas fa-play-circle"></i>
                </span>
                <span>JM2D (Ours)</span>
              </span>
            </a>
          </li>
          <li data-target="donut-video2" class="tab-item">
            <a class="has-text-weight-bold">
              <span class="icon-text">
                <span class="icon">
                  <i class="fas fa-play-circle"></i>
                </span>
                <span>Sequential Sampling</span>
              </span>
            </a>
          </li>
        </ul>
      </div>

      <style>
        .tab-item {
          transition: all 0.3s ease;
          border-radius: 8px;
          margin: 0 1px;
        }
        
        .tab-item:hover {
          background-color: #f5f5f5;
          transform: translateY(-2px);
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .tab-item.is-active {
          background-color: #3273dc;
          color: white !important;
        }
        
        .tab-item.is-active a {
          color: white !important;
        }
        
        .tab-item a {
          padding: 0.3em 0.6em;
          border-radius: 8px;
          white-space: nowrap;
          font-size: 0.95em;
        }
        
        .icon-text {
          display: flex;
          align-items: center;
          gap: 0.05em;
        }
        
        .icon {
          transition: transform 0.3s ease;
          font-size: 0.8em;
        }
        
        .tab-item:hover .icon {
          transform: scale(1.2);
        }

        .tabs ul {
          flex-wrap: nowrap;
          justify-content: center;
        }
      </style>

      <!-- <p class="has-text-centered"> -->
        <!-- Click on the tabs to watch tasks videos in <strong>1x</strong> video speed. -->
        <!-- We extensively test SAIL on <strong>6 tasks</strong> across <strong>two real robot</strong> platforms, demonstrating smoother trajectory and careful system design lead to <strong>3.2× speedup</strong> over demonstration speed. -->
      <!-- </p> -->

      <!-- Video Container -->
      <div class="columns is-centered real-world-content">
        <div class="column is-full">
          <!-- Video 1 -->
          <div id="donut-video1" class="video-content is-active">
            <video autoplay muted playsinline controls width="30%" 
                  style="display:block; margin: 0 auto;" 
                  onended="handleVideoEnd(this)">
              <!-- <source src="./static/videos/stacking_cup_sail_baseline.mp4" type="video/mp4"> -->
              <source src="./static/videos/donut/jm2d.mp4" type="video/mp4">
            </video>
            <!-- <p class="has-text-centered mt-2">Stacking Cups to Pyramid Shape</p> -->
          </div>
          
          <!-- Video 2 -->
          <div id="donut-video2" class="video-content">
            <video autoplay muted playsinline controls width="30%" 
                  style="display:block; margin: 0 auto;" 
                  onended="handleVideoEnd(this)">
              <source src="./static/videos/donut/sequential.mp4" type="video/mp4">
            </video>
            <!-- <p class="has-text-centered mt-2">Wiping Board</p> -->
          </div>
        </div>
      </div>
    </div>
    

    <p class="is-4" style="max-width: 800px; margin: 0 auto 1.5rem auto;">
      <b>Setting.</b> A model-free planner <b>p<sub>θ</sub>(x)</b> samples start–goal pairs (●, ●) in a donut-shaped region (gray).
      A model-based optimization module finds a waypoint (★) so that the path (●-★-●) is the longest collision-free route 
      that avoids inference-time obstacles (transparent red circles).
    </p>

    <div class="centered-image">
      <img src="static/images/donut_problem.png" alt="Donut" width="20%">
    </div>

    <p class="is-4" style="max-width: 800px; margin: 0 auto 1.5rem auto;">
      <b> Result.</b> Sequential sampling often produces infeasible pairs (i.e., the path intersects with obstacles). In contrast, <b class="viridis-text"> JM2D</b> jointly searches over 
      (𝑥,𝑘), achieving the highest rate of compatible samples.
    </p>

    <!-- Image -->
    <div class="centered-image">
      <img src="static/images/donut_result.png" alt="Donut" width="60%">
    </div>
  </div>
</section>

<!-- Maze Example -->
<!-- Placeholder for maze video carousel -->
<!-- Fun Idea: can user select initial position, goal? -->
<section class="section is-light is-small">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered"> Results: What can <b class="viridis-text"> JM2D</b> do?</h2>
    <div class="content mb-5">
      <h2 class="title is-4"> (1) <b class="viridis-text">JM2D</b> increases system performance under strict safety guarantee</h2>
      <div class="content">
        <b> Safety filter as JM2D.</b> Classic safety filters pair a learning policy with a verified backup: if the learned action is unsafe, the backup overrides it, 
        guaranteeing safety but often degrading performance when objectives conflict. 
        <b class="viridis-text">JM2D</b> inserts joint sampling between the two, reducing policy–backup conflict while preserving safety guarantees. 
        We evaluate on (1) safe manipulation with novel obstacles and (2) safe navigation in novel mazes.
      </div>
      

      <div class="columns is-centered">
        <div class="column is-centered">
          <h2 class="title is-5"> Safe Manipulation with Novel Obstacles</h2>
        </div>
      </div>

      <!-- Video Tabs -->
      <div class="tabset">
        <div class="tabs is-centered is-medium mb-3 real-world-tabs">
          <ul>
            <li data-target="real-video1" class="tab-item is-active">
              <a class="has-text-weight-bold">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fas fa-play-circle"></i>
                  </span>
                  <span>JM2D (Ours)</span>
                </span>
              </a>
            </li>
            <li data-target="real-video2" class="tab-item">
              <a class="has-text-weight-bold">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fas fa-play-circle"></i>
                  </span>
                  <span>Diffusion Policy (DP) </span>
                </span>
              </a>
            </li>
            <li data-target="real-video3" class="tab-item">
              <a class="has-text-weight-bold">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fas fa-play-circle"></i>
                  </span>
                  <span>DP + Safety Filter</span>
                </span>
              </a>
            </li>
          </ul>
        </div>

        <style>
          .tab-item {
            transition: all 0.3s ease;
            border-radius: 8px;
            margin: 0 1px;
          }
          
          .tab-item:hover {
            background-color: #f5f5f5;
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          }
          
          .tab-item.is-active {
            background-color: #3273dc;
            color: white !important;
          }
          
          .tab-item.is-active a {
            color: white !important;
          }
          
          .tab-item a {
            padding: 0.3em 0.6em;
            border-radius: 8px;
            white-space: nowrap;
            font-size: 0.95em;
          }
          
          .icon-text {
            display: flex;
            align-items: center;
            gap: 0.05em;
          }
          
          .icon {
            transition: transform 0.3s ease;
            font-size: 0.8em;
          }
          
          .tab-item:hover .icon {
            transform: scale(1.2);
          }

          .tabs ul {
            flex-wrap: nowrap;
            justify-content: center;
          }
        </style>

        <!-- <p class="has-text-centered"> -->
          <!-- Click on the tabs to watch tasks videos in <strong>1x</strong> video speed. -->
          <!-- We extensively test SAIL on <strong>6 tasks</strong> across <strong>two real robot</strong> platforms, demonstrating smoother trajectory and careful system design lead to <strong>3.2× speedup</strong> over demonstration speed. -->
        <!-- </p> -->

        <!-- Video Container -->
        <div class="columns is-centered real-world-content">
          <div class="column is-full">
            <!-- Video 1 -->
            <div id="real-video1" class="video-content is-active">
              <video autoplay muted playsinline controls width="90%" 
                    style="display:block; margin: 0 auto;" 
                    onended="handleVideoEnd(this)">
                <source src="./static/videos/real/jm2d.mp4" type="video/mp4">
              </video>
              <!-- <p class="has-text-centered mt-2">Wiping Board</p> -->
            </div>

            <!-- Video 2 -->
            <div id="real-video2" class="video-content">
              <video autoplay muted playsinline controls width="90%" 
                    style="display:block; margin: 0 auto;" 
                    onended="handleVideoEnd(this)">
                <!-- <source src="./static/videos/stacking_cup_sail_baseline.mp4" type="video/mp4"> -->
                <source src="./static/videos/real/dp.mp4" type="video/mp4">
              </video>
              <!-- <p class="has-text-centered mt-2">Stacking Cups to Pyramid Shape</p> -->
            </div>

            <!-- Video 3 -->
            <div id="real-video3" class="video-content">
              <video autoplay muted playsinline controls width="90%" 
                    style="display:block; margin: 0 auto;" 
                    onended="handleVideoEnd(this)">
                <source src="./static/videos/real/rail.mp4" type="video/mp4">
              </video>
              <!-- <p class="has-text-centered mt-2">Wiping Board</p> -->
            </div>
          </div>
        </div>
      </div>

      <div class="columns is-centered">
        <div class="column">
          <div class="content">
            <p>
              <b>Setting.</b> The robot must pick and place a mug while avoiding novel obstacles that appear only at inference time.
              Diffusion Policy (DP) is trained without these obstacles; we compare <b class="viridis-text"> JM2D</b> against DP and a conventional safety filter.
            </p>
          </div>
        </div>
      </div>

      <div class="columns is-centered">
        <div class="column">
          <div class="content">
            <p>
              <b>Result.</b> DP collides with the new obstacles. The safety filter avoids collisions but requires frequent interventions, 
              increasing task completion time. <b class="viridis-text"> JM2D</b> experiences 3x less safety interventions and 2x faster
              task completion time, all in real time.
            </p>
          </div>
        </div>
      </div>


      <div class="columns is-centered">
        <div class="column">
          <h2 class="title is-5"> Safe Navigation in Novel Mazes</h2>
        </div>
      </div>

      <!-- Video Tabs -->
      <div class="tabset">
        <div class="tabs is-centered is-medium mb-3 real-world-tabs">
          <ul>
            <li data-target="maze-video1" class="tab-item is-active">
              <a class="has-text-weight-bold">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fas fa-play-circle"></i>
                  </span>
                  <span>JM2D (Ours)</span>
                </span>
              </a>
            </li>
            <li data-target="maze-video2" class="tab-item">
              <a class="has-text-weight-bold">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fas fa-play-circle"></i>
                  </span>
                  <span>Diffusion Policy (DP) </span>
                </span>
              </a>
            </li>
            <li data-target="maze-video3" class="tab-item">
              <a class="has-text-weight-bold">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fas fa-play-circle"></i>
                  </span>
                  <span>DP + Safety Filter</span>
                </span>
              </a>
            </li>
          </ul>
        </div>

        <style>
          .tab-item {
            transition: all 0.3s ease;
            border-radius: 8px;
            margin: 0 1px;
          }
          
          .tab-item:hover {
            background-color: #f5f5f5;
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          }
          
          .tab-item.is-active {
            background-color: #3273dc;
            color: white !important;
          }
          
          .tab-item.is-active a {
            color: white !important;
          }
          
          .tab-item a {
            padding: 0.3em 0.6em;
            border-radius: 8px;
            white-space: nowrap;
            font-size: 0.95em;
          }
          
          .icon-text {
            display: flex;
            align-items: center;
            gap: 0.05em;
          }
          
          .icon {
            transition: transform 0.3s ease;
            font-size: 0.8em;
          }
          
          .tab-item:hover .icon {
            transform: scale(1.2);
          }

          .tabs ul {
            flex-wrap: nowrap;
            justify-content: center;
          }
        </style>

        <!-- <p class="has-text-centered"> -->
          <!-- Click on the tabs to watch tasks videos in <strong>1x</strong> video speed. -->
          <!-- We extensively test SAIL on <strong>6 tasks</strong> across <strong>two real robot</strong> platforms, demonstrating smoother trajectory and careful system design lead to <strong>3.2× speedup</strong> over demonstration speed. -->
        <!-- </p> -->

        <!-- Video Container -->
        <div class="columns is-centered real-world-content">
          <div class="column is-full">
            <!-- Video 1 -->
            <div id="maze-video1" class="video-content is-active">
              <video autoplay muted playsinline controls width="30%" 
                    style="display:block; margin: 0 auto;" 
                    onended="handleVideoEnd(this)">
                <source src="./static/videos/maze/jm2d.mp4" type="video/mp4">
              </video>
              <!-- <p class="has-text-centered mt-2">Wiping Board</p> -->
            </div>

            <!-- Video 2 -->
            <div id="maze-video2" class="video-content">
              <video autoplay muted playsinline controls width="30%" 
                    style="display:block; margin: 0 auto;" 
                    onended="handleVideoEnd(this)">
                <!-- <source src="./static/videos/stacking_cup_sail_baseline.mp4" type="video/mp4"> -->
                <source src="./static/videos/maze/dp.mp4" type="video/mp4">
              </video>
              <!-- <p class="has-text-centered mt-2">Stacking Cups to Pyramid Shape</p> -->
            </div>

            <!-- Video 3 -->
            <div id="maze-video3" class="video-content">
              <video autoplay muted playsinline controls width="30%" 
                    style="display:block; margin: 0 auto;" 
                    onended="handleVideoEnd(this)">
                <source src="./static/videos/maze/rail.mp4" type="video/mp4">
              </video>
              <!-- <p class="has-text-centered mt-2">Wiping Board</p> -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <p class="has-text-centered is-size-7" style="margin-top: .5rem;">
      <span class="tag is-danger is-light">Red = safety violation</span>
      <span class="tag is-success is-light">Green Circle = intervened</span>
      <span class="tag is-link is-light">Blue Circle = not intervened</span>
    </p>

    <div class="columns is-centered">
      <div class="column">
        <div class="content">
          <p>
            <b>Setting.</b> The robot must reach its goal (red) while avoiding walls, even when they are padded at 
            inference time. Diffusion Policy (DP) is trained only on the unpadded environment; 
            we compare <b class="viridis-text"> JM2D</b> against DP and a safety filter, under various paddings.
            The video goes red when safety is violated.
            Green circle means intevened, blue circle means not intervened.
          </p>
        </div>
      </div>
    </div>

    <!-- Image Tabs -->
    <div class="centered-image">
      <img src="static/images/maze_problem.png" alt="Maze" width="80%">
    </div>

    <p style="margin-bottom: 20px;">          
      <b>Result.</b> <b class="viridis-text">JM2D</b> balances task completion and safety in a unified way. 
      DP alone fails when unseen obstacles appear, while the conventional safety filter, RAIL, improves safety but reduces performance. 
      By jointly sampling plans and safety corrections, <b class="viridis-text"> JM2D</b> consistently achieves higher success rates, 
      fewer interventions, and faster task completion.
    </p>


    <div class="centered-image">
      <img src="static/images/maze_result.png" alt="Maze" width="90%">
    </div>
      
    </div>

      
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-4">(2) <b class="viridis-text"> JM2D</b> generalizes Conditional Generation and Model-based Diffusion</h2>
    <p style="margin-bottom: 20px;">
      <b> Overview.</b> No backup policy? 
      You can still use <span class="viridis-text">JM2D</span>. 
      As shown in paper, <span class="viridis-text">JM2D</span> subsumes conditional generation and model-based diffusion, 
      so you can deploy only the conditional-generation component when a backup policy is unavailable. 
      We benchmark this setting against prior diffusion-based motion planners with safety constraints. 
    </p>
    <div class="centered-image">
      <img src="static/images/sim_problem.png" alt="Donut" width="80%">
    </div>
    <p style="margin-bottom: 20px;">
      <b> Setting. </b> The robot must reach the green line without contacting red obstacles. 
      At inference, additional blue obstacles are introduced as safety constraints. 
      We evaluate four scenarios: the three from the DPCC benchmark and a new Cluttered case. 
      Baselines include a gradient-based planner (MPD) and projection-based diffusion planners (DPCC, SafeDiffuser).
    </p>
    <div class="centered-image">
      <img src="static/images/sim_result.png" alt="Sim Result" width="80%">
      <img src="static/images/sim_table.png" alt="Sim Table" width="80%">
    </div>
    <p style="margin-bottom: 20px;">
      <b> Result. </b> 
      <span class="viridis-text">JM2D</span> yields higher success with fewer constraint violations. 
      It produces higher-fidelity, dynamically feasible plans while respecting safety constraints, outperforming all baselines.
    </p>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-4">(3) <b class="viridis-text">JM2D </b> is training-free and gradient-free</h2>
    <p> 
      The most appealing property of <span class="viridis-text">JM2D</span> is that it is <b>training-free</b> and <b>gradient-free</b>.
      This allows us to use many combinations of modules in a modular way.
    </p>
  </div>
</section>

<section class="section" id="contact">
  <div class="container is-max-desktop content">
      <h2 class="title">Contact</h2>
      For more discussion and questions, please contact <a href="https://wonsuhkjung.wordpress.com/">Wonsuhk Jung</a>
  </div>
</section>

<!-- Placeholder for bibliography -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{
    jung2025joint,
    title={Joint Model-based Model-free Diffusion for Planning with Constraints},
    author={Wonsuhk Jung and Utkarsh Aashu Mishra and Nadun Ranawaka Arachchige and Yongxin Chen and Danfei Xu and Shreyas Kousik},
    booktitle={9th Annual Conference on Robot Learning},
    year={2025},
    url={https://openreview.net/forum?id=E9t1ekt6W9}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is based on the <a href = "https://nerfies.github.io/"> Nerfies </a> website template, which is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- <script>
  // Tab switching for the "real-world-tabs" block
  function setActiveTab(targetId) {
    // Deactivate all tabs
    document.querySelectorAll('.real-world-tabs .tab-item')
      .forEach(li => li.classList.remove('is-active'));

    // Deactivate all panels and pause/reset their videos
    document.querySelectorAll('.real-world-content .video-content')
      .forEach(panel => {
        panel.classList.remove('is-active');
        panel.querySelectorAll('video').forEach(v => { v.pause(); v.currentTime = 0; });
      });

    // Activate clicked tab
    const activeTab = document.querySelector(`.real-world-tabs .tab-item[data-target="${targetId}"]`);
    if (activeTab) activeTab.classList.add('is-active');

    // Activate corresponding panel and (try to) play its video
    const activePanel = document.getElementById(targetId);
    if (activePanel) {
      activePanel.classList.add('is-active');
      const v = activePanel.querySelector('video');
      if (v) v.play().catch(()=>{ /* Autoplay might be blocked; ignore */ });
    }
  }

  // Wire up events after DOM loads
  document.addEventListener('DOMContentLoaded', () => {
    // Tab clicks
    document.querySelectorAll('.real-world-tabs .tab-item').forEach(li => {
      li.addEventListener('click', () => setActiveTab(li.dataset.target));
    });

    // Optional: navbar burger for mobile (since you included it)
    const burger = document.querySelector('.navbar-burger');
    const menu = document.querySelector('.navbar-menu');
    if (burger && menu) {
      burger.addEventListener('click', () => {
        burger.classList.toggle('is-active');
        menu.classList.toggle('is-active');
      });
    }
  });

  // (You already had this—kept for completeness)
  function handleVideoEnd(video) {
    video.pause();
    setTimeout(() => { video.currentTime = 0; video.play(); }, 2000);
  }
</script> -->

<script>
  function handleVideoEnd(video) {
    video.pause();
    setTimeout(() => { video.currentTime = 0; video.play(); }, 2000);
  }

  document.addEventListener('DOMContentLoaded', () => {
    // For each tabset, wire up local tab behavior
    document.querySelectorAll('.tabset').forEach((tabset) => {
      const tabs   = tabset.querySelectorAll('.real-world-tabs .tab-item');
      const panels = tabset.querySelectorAll('.real-world-content .video-content');

      // Helper to activate a target panel within this tabset
      function setActive(targetId) {
        // deactivate all tabs in this tabset
        tabs.forEach(li => li.classList.remove('is-active'));

        // deactivate all panels & reset videos in this tabset
        panels.forEach(panel => {
          panel.classList.remove('is-active');
          panel.querySelectorAll('video').forEach(v => { v.pause(); v.currentTime = 0; });
        });

        // activate clicked tab
        const activeTab = tabset.querySelector(`.real-world-tabs .tab-item[data-target="${targetId}"]`);
        if (activeTab) activeTab.classList.add('is-active');

        // activate target panel
        const activePanel = tabset.querySelector(`#${targetId}`);
        if (activePanel) {
          activePanel.classList.add('is-active');
          const v = activePanel.querySelector('video');
          if (v) v.play().catch(() => {});
        }
      }

      // Wire clicks
      tabs.forEach(li => li.addEventListener('click', () => setActive(li.dataset.target)));

      // Optional: ensure the first .is-active tab shows its panel on load
      const initiallyActive = tabset.querySelector('.real-world-tabs .tab-item.is-active');
      if (initiallyActive) setActive(initiallyActive.dataset.target);
    });

    // Burger for mobile
    const burger = document.querySelector('.navbar-burger');
    const menu = document.querySelector('.navbar-menu');
    if (burger && menu) {
      burger.addEventListener('click', () => {
        burger.classList.toggle('is-active');
        menu.classList.toggle('is-active');
      });
    }
  });
</script>

</body>
</html>
